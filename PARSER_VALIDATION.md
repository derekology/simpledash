# Parser Validation Behavior

## Overview

All parsers now consistently validate that campaigns have **all required fields** before including them in the results. This ensures data quality and prevents incomplete campaigns from reaching the frontend.

## Required Fields

For a campaign to pass validation (`has_meaningful_data()`), it must have ALL of:
- `platform` (always set by parser)
- `subject`
- `email_title`
- `unique_id` (generated by parser)
- `sent_at`
- `delivered`
- `opens`
- `open_rate`
- `clicks`
- `click_rate`

## Parser Behavior

### MailerLiteClassicParser
- Parses single campaign per report
- **Raises `EmptyReportError`** if required fields are missing
- Ensures incomplete reports are rejected entirely

### MailChimpParser
- Parses single campaign per report
- **Raises `EmptyReportError`** if required fields are missing
- Ensures incomplete reports are rejected entirely

### MailChimpABParser (Updated)
- Parses multiple combinations per report
- **Silently skips** combinations that don't have all required fields
- Only returns valid combinations
- **Raises `EmptyReportError`** if NO valid combinations found

### MailChimpAggregatedParser (Updated)
- Parses multiple campaigns from CSV
- **Silently skips** rows that:
  - Fail to parse (ValueError, KeyError)
  - Parse successfully but lack required fields
- Only returns valid campaigns
- **Raises `EmptyReportError`** if NO valid campaigns found

## Rationale

**Single Campaign Parsers** (MailerLite, MailChimp): 
- Strict validation with errors
- If the report is incomplete, the entire file is invalid
- User should be notified with clear error message

**Multiple Campaign Parsers** (A/B, Aggregated):
- Lenient validation with skipping
- Partial data is acceptable - keep valid campaigns, skip invalid ones
- Users often upload mixed-quality aggregated data
- Better UX to show what we can parse rather than reject entire file

## Error Messages

Users will see descriptive errors on the frontend:
- `"Empty report: Campaign data incomplete or missing key metrics"` - Single campaign missing data
- `"Empty report: No combinations found in A/B test report"` - A/B test with no valid combinations  
- `"Empty report: No valid campaigns found in aggregated report"` - Aggregated CSV with no valid rows

## Testing

See `tests/test_validation.py` for comprehensive validation tests across all parser types.
